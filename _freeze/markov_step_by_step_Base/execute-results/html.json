{
  "hash": "1d33d49b8d5356558b9cccc1060f6099",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Markov Modeling: A Detailed Guide\"\nformat:\n  html:\n    toc: true\n    toc-depth: 3\n    number-sections: true\n    self-contained: true\n    code-fold: true\nexecute:\n  echo: true\n  warning: false\n  message: false\n---\n\n\n\n\n## Introduction to Markov Modeling\n\nA **Markov model** is a powerful tool for analyzing a patient's journey over an extended period. Unlike a decision tree, which is a snapshot in time, a Markov model simulates how a group of patients moves through different health states over many years. It is perfect for analyzing chronic diseases like heart disease, where a patient's condition can change over time. In this exercise, we will build a Markov model to compare two treatment strategies for coronary artery disease: **Percutaneous Coronary Intervention (PCI)** and **Coronary Artery Bypass Grafting (CABG)**. We will simulate a cohort of patients over a 10-year period, tracking their health states, costs, and quality-adjusted life years (QALYs). ---\n\n### Key Concepts\n\n-   **Health States**: These are the possible clinical conditions a patient can be in. We will use a simplified set of states for our model:\n    -   `Stable`: The patient is healthy and has stable symptoms.\n    -   `Myocardial Infarction (MI)`: The patient has a heart attack.\n    -   `Reintervention`: The patient requires a repeat procedure.\n    -   `Death`: The patient has died (this is an **absorbing state**, meaning once a patient enters this state, they cannot leave).\n-   **Cycles**: The model runs in discrete time periods, or cycles. Our cycles will be one year long.\n-   **Transition Probabilities**: These are the probabilities that a patient will move from one health state to another in a single cycle. These values come from a literature review of clinical trials.\n-   **Costs and Utilities**: Each health state has associated costs (e.g., medical expenses) and utilities (e.g., quality of life). We will use these to calculate the total cost and QALYs for each treatment strategy.\n\n------------------------------------------------------------------------\n\n### Visualizing the Markov Model\n\nThis diagram shows how a patient can move between the different health states in our model. The arrows represent the possible transitions in a single cycle.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Check and install DiagrammeR if not already installed\nif (!requireNamespace(\"DiagrammeR\", quietly = TRUE)) {\n  install.packages(\"DiagrammeR\")\n}\nlibrary(DiagrammeR)\n\n# Create the visual representation of the Markov model\ngrViz(\"\n  digraph G {\n    graph [overlap = true, splines = true, fontname = Helvetica, layout = dot]\n\n    // Define nodes with shapes and labels\n    node [shape = rectangle, style = filled, color = LightBlue, fontname = Helvetica]\n    Stable;\n    MI [color = LightCoral];\n    Reintervention [color = LightYellow];\n    Death [shape = hexagon, color = Gray];\n\n    // Define transitions (edges)\n    Stable -> Stable [label = 'P(stable to stable)'];\n    Stable -> MI [label = 'P(stable to MI)'];\n    Stable -> Reintervention [label = 'P(stable to reintervention)'];\n    Stable -> Death [label = 'P(stable to death)'];\n\n    MI -> Stable [label = 'P(MI to stable)'];\n    MI -> Reintervention [label = 'P(MI to reintervention)'];\n    MI -> Death [label = 'P(MI to death)'];\n\n    Reintervention -> Stable [label = 'P(reintervention to stable)'];\n    Reintervention -> Death [label = 'P(reintervention to death)'];\n\n    // Death is an absorbing state\n    Death -> Death [label = 'P(death to death) = 1', color = Gray];\n  }\n\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"grViz html-widget html-fill-item\" id=\"htmlwidget-caa26e933f6f248e4b6b\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-caa26e933f6f248e4b6b\">{\"x\":{\"diagram\":\"\\n  digraph G {\\n    graph [overlap = true, splines = true, fontname = Helvetica, layout = dot]\\n\\n    // Define nodes with shapes and labels\\n    node [shape = rectangle, style = filled, color = LightBlue, fontname = Helvetica]\\n    Stable;\\n    MI [color = LightCoral];\\n    Reintervention [color = LightYellow];\\n    Death [shape = hexagon, color = Gray];\\n\\n    // Define transitions (edges)\\n    Stable -> Stable [label = \\\"P(stable to stable)\\\"];\\n    Stable -> MI [label = \\\"P(stable to MI)\\\"];\\n    Stable -> Reintervention [label = \\\"P(stable to reintervention)\\\"];\\n    Stable -> Death [label = \\\"P(stable to death)\\\"];\\n\\n    MI -> Stable [label = \\\"P(MI to stable)\\\"];\\n    MI -> Reintervention [label = \\\"P(MI to reintervention)\\\"];\\n    MI -> Death [label = \\\"P(MI to death)\\\"];\\n\\n    Reintervention -> Stable [label = \\\"P(reintervention to stable)\\\"];\\n    Reintervention -> Death [label = \\\"P(reintervention to death)\\\"];\\n\\n    // Death is an absorbing state\\n    Death -> Death [label = \\\"P(death to death) = 1\\\", color = Gray];\\n  }\\n\",\"config\":{\"engine\":\"dot\",\"options\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\n------------------------------------------------------------------------\n\n## Building a Markov Model Step-by-Step\n\n**Objective:** To build a working Markov model in R to compare the long-term cost and health outcomes of PCI versus CABG.\n\n### Step 1: Define Model Parameters\n\nIn this first step, we'll define all the parameters for our model. These are the costs, utilities, and transition probabilities we've gathered from our hypothetical literature review.\n\n#### 1.1 Define States\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstate_names <- c(\"Stable\", \"MI\", \"Reintervention\", \"Death\")\n```\n:::\n\n\n\n\n#### 1.2 Define Costs\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Costs in Indian Rupees (INR)\ncost_pci_initial <- 200000 # Cost of the initial PCI procedure for the cohort\ncost_cabg_initial <- 300000 # Cost of the initial CABG procedure for the cohort\ncost_stable <- 50000 # Annual cost for a stable patient\ncost_mi <- 20000 # Cost of a myocardial infarction event\ncost_reintervention <- 150000 # Cost of a reintervention\ncost_death <- 0 # Cost for the absorbing state\n```\n:::\n\n\n\n\n#### 1.2.1 Show costs\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncosts_table <- tibble::tibble(\n  State = state_names,\n  Cost = c(cost_stable, cost_mi, cost_reintervention, cost_death)\n)\n# Check and install gt if not already installed for table formatting\nif (!requireNamespace(\"gt\", quietly = TRUE)) {\n  install.packages(\"gt\")\n}\nlibrary(gt)\ngt(costs_table)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"owijsytbuk\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#owijsytbuk table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#owijsytbuk thead, #owijsytbuk tbody, #owijsytbuk tfoot, #owijsytbuk tr, #owijsytbuk td, #owijsytbuk th {\n  border-style: none;\n}\n\n#owijsytbuk p {\n  margin: 0;\n  padding: 0;\n}\n\n#owijsytbuk .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#owijsytbuk .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#owijsytbuk .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#owijsytbuk .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#owijsytbuk .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#owijsytbuk .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#owijsytbuk .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#owijsytbuk .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#owijsytbuk .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#owijsytbuk .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#owijsytbuk .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#owijsytbuk .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#owijsytbuk .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#owijsytbuk .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#owijsytbuk .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#owijsytbuk .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#owijsytbuk .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#owijsytbuk .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#owijsytbuk .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#owijsytbuk .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#owijsytbuk .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#owijsytbuk .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#owijsytbuk .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#owijsytbuk .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#owijsytbuk .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#owijsytbuk .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#owijsytbuk .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#owijsytbuk .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#owijsytbuk .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#owijsytbuk .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#owijsytbuk .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#owijsytbuk .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#owijsytbuk .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#owijsytbuk .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#owijsytbuk .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#owijsytbuk .gt_left {\n  text-align: left;\n}\n\n#owijsytbuk .gt_center {\n  text-align: center;\n}\n\n#owijsytbuk .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#owijsytbuk .gt_font_normal {\n  font-weight: normal;\n}\n\n#owijsytbuk .gt_font_bold {\n  font-weight: bold;\n}\n\n#owijsytbuk .gt_font_italic {\n  font-style: italic;\n}\n\n#owijsytbuk .gt_super {\n  font-size: 65%;\n}\n\n#owijsytbuk .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#owijsytbuk .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#owijsytbuk .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#owijsytbuk .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#owijsytbuk .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#owijsytbuk .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#owijsytbuk .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#owijsytbuk .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#owijsytbuk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"State\">State</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Cost\">Cost</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"State\" class=\"gt_row gt_left\">Stable</td>\n<td headers=\"Cost\" class=\"gt_row gt_right\">50000</td></tr>\n    <tr><td headers=\"State\" class=\"gt_row gt_left\">MI</td>\n<td headers=\"Cost\" class=\"gt_row gt_right\">20000</td></tr>\n    <tr><td headers=\"State\" class=\"gt_row gt_left\">Reintervention</td>\n<td headers=\"Cost\" class=\"gt_row gt_right\">150000</td></tr>\n    <tr><td headers=\"State\" class=\"gt_row gt_left\">Death</td>\n<td headers=\"Cost\" class=\"gt_row gt_right\">0</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n#### 1.3 Utilities\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Utilities (Quality-Adjusted Life Years - QALYs)\nutility_stable <- 0.85 # Utility value for a stable patient\nutility_mi <- 0.6 # Utility value during the year of an MI\nutility_reintervention <- 0.7 # Utility value during the year of a reintervention\nutility_death <- 0 # Utility value for the absorbing state\n```\n:::\n\n\n\n\n#### 1.3.1 Show utilities\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nutilities_table <- tibble::tibble(\n  State = c(\"Stable\", \"Myocardial Infarction\", \"Reintervention\", \"Death\"),\n  Utility = c(utility_stable, utility_mi, utility_reintervention, utility_death)\n)\ngt(utilities_table)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"rjzbsbqnvu\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#rjzbsbqnvu table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#rjzbsbqnvu thead, #rjzbsbqnvu tbody, #rjzbsbqnvu tfoot, #rjzbsbqnvu tr, #rjzbsbqnvu td, #rjzbsbqnvu th {\n  border-style: none;\n}\n\n#rjzbsbqnvu p {\n  margin: 0;\n  padding: 0;\n}\n\n#rjzbsbqnvu .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#rjzbsbqnvu .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#rjzbsbqnvu .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#rjzbsbqnvu .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#rjzbsbqnvu .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rjzbsbqnvu .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rjzbsbqnvu .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rjzbsbqnvu .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#rjzbsbqnvu .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#rjzbsbqnvu .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#rjzbsbqnvu .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#rjzbsbqnvu .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#rjzbsbqnvu .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#rjzbsbqnvu .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#rjzbsbqnvu .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#rjzbsbqnvu .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#rjzbsbqnvu .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#rjzbsbqnvu .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#rjzbsbqnvu .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rjzbsbqnvu .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#rjzbsbqnvu .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#rjzbsbqnvu .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#rjzbsbqnvu .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rjzbsbqnvu .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#rjzbsbqnvu .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#rjzbsbqnvu .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rjzbsbqnvu .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rjzbsbqnvu .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#rjzbsbqnvu .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rjzbsbqnvu .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#rjzbsbqnvu .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rjzbsbqnvu .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rjzbsbqnvu .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rjzbsbqnvu .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rjzbsbqnvu .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rjzbsbqnvu .gt_left {\n  text-align: left;\n}\n\n#rjzbsbqnvu .gt_center {\n  text-align: center;\n}\n\n#rjzbsbqnvu .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#rjzbsbqnvu .gt_font_normal {\n  font-weight: normal;\n}\n\n#rjzbsbqnvu .gt_font_bold {\n  font-weight: bold;\n}\n\n#rjzbsbqnvu .gt_font_italic {\n  font-style: italic;\n}\n\n#rjzbsbqnvu .gt_super {\n  font-size: 65%;\n}\n\n#rjzbsbqnvu .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#rjzbsbqnvu .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#rjzbsbqnvu .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#rjzbsbqnvu .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#rjzbsbqnvu .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#rjzbsbqnvu .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#rjzbsbqnvu .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#rjzbsbqnvu .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#rjzbsbqnvu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"State\">State</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Utility\">Utility</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"State\" class=\"gt_row gt_left\">Stable</td>\n<td headers=\"Utility\" class=\"gt_row gt_right\">0.85</td></tr>\n    <tr><td headers=\"State\" class=\"gt_row gt_left\">Myocardial Infarction</td>\n<td headers=\"Utility\" class=\"gt_row gt_right\">0.60</td></tr>\n    <tr><td headers=\"State\" class=\"gt_row gt_left\">Reintervention</td>\n<td headers=\"Utility\" class=\"gt_row gt_right\">0.70</td></tr>\n    <tr><td headers=\"State\" class=\"gt_row gt_left\">Death</td>\n<td headers=\"Utility\" class=\"gt_row gt_right\">0.00</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n#### 1.4 Discounting\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Discounting\ndiscount_rate_cost <- 0.03 # A common discount rate for costs (5%)\ndiscount_rate_qaly <- 0.03 # A common discount rate for QALYs (5%)\n```\n:::\n\n\n\n\n#### 1.5 Define Transition Probabilities for PCI and CABG\n\n##### 1.5.1 PCI Transition Probabilities\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Transition probabilities from literature for a 1-year cycle\npci_trans <- list(\n  stable_to_stable = 0.70,\n  stable_to_mi = 0.15,\n  stable_to_reintervention = 0.10,\n  stable_to_death = 0.05,\n  mi_to_reintervention = 0.20,\n  mi_to_stable = 0.50,\n  mi_to_death = 0.30,\n  reintervention_to_stable = 0.80,\n  reintervention_to_death = 0.20\n)\n```\n:::\n\n\n\n\n##### 1.5.2 CABG Transition Probabilities\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncabg_trans <- list(\n  stable_to_stable = 0.80,\n  stable_to_mi = 0.08,\n  stable_to_reintervention = 0.07,\n  stable_to_death = 0.05,\n  mi_to_reintervention = 0.10,\n  mi_to_stable = 0.60,\n  mi_to_death = 0.30,\n  reintervention_to_stable = 0.80,\n  reintervention_to_death = 0.20\n)\n```\n:::\n\n\n\n\n### Step 2: Build the Transition Matrix\n\nThe **transition matrix** is the engine of our Markov model. It's a square matrix where each row represents the starting health state and each column represents the destination health state. The value at each intersection is the probability of that transition occurring.\n\n**Instructions:** Create two matrices, one for PCI and one for CABG, using the probabilities we defined in the previous step.\n\n#### 2.1 Matrix Construction for PCI\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# PCI Transition Matrix\ntrans_pci <- matrix(\n  c(\n    pci_trans$stable_to_stable, pci_trans$stable_to_mi, pci_trans$stable_to_reintervention, pci_trans$stable_to_death, # From Stable...\n    pci_trans$mi_to_stable, 0, pci_trans$mi_to_reintervention, pci_trans$mi_to_death, # From MI...\n    pci_trans$reintervention_to_stable, 0, 0, pci_trans$reintervention_to_death, # From Reintervention...\n    0, 0, 0, 1 # From Death (absorbing state)\n  ),\n  nrow = 4,\n  byrow = TRUE,\n  dimnames = list(state_names, state_names)\n)\n# Print the matrices to see their structure\nprint(\"PCI Transition Matrix:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"PCI Transition Matrix:\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(trans_pci)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Stable   MI Reintervention Death\nStable            0.7 0.15            0.1  0.05\nMI                0.5 0.00            0.2  0.30\nReintervention    0.8 0.00            0.0  0.20\nDeath             0.0 0.00            0.0  1.00\n```\n\n\n:::\n:::\n\n\n\n\n#### 2.1.1 Validation of Transition Matrices\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrowSums(trans_pci)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        Stable             MI Reintervention          Death \n             1              1              1              1 \n```\n\n\n:::\n\n```{.r .cell-code}\ntrans_pci[\"Death\", ]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        Stable             MI Reintervention          Death \n             0              0              0              1 \n```\n\n\n:::\n:::\n\n\n\n\n> **Beginner tip:** Rows are ‘from’, columns are ‘to’. Each row must sum to 1. ‘Death’ is an absorbing row [0,0,0,1].\n\n#### 2.2 Matrix Construction for CABG\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# CABG Transition Matrix\ntrans_cabg <- matrix(\n  c(\n    cabg_trans$stable_to_stable, cabg_trans$stable_to_mi, cabg_trans$stable_to_reintervention, cabg_trans$stable_to_death, # From Stable...\n    cabg_trans$mi_to_stable, 0, cabg_trans$mi_to_reintervention, cabg_trans$mi_to_death, # From MI...\n    cabg_trans$reintervention_to_stable, 0, 0, cabg_trans$reintervention_to_death, # From Reintervention...\n    0, 0, 0, 1 # From Death (absorbing state)\n  ),\n  nrow = 4,\n  byrow = TRUE,\n  dimnames = list(c(\"Stable\", \"MI\", \"Reintervention\", \"Death\"), c(\"Stable\", \"MI\", \"Reintervention\", \"Death\"))\n)\n\n# Print the matrices to see their structure\nprint(\"CABG Transition Matrix:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"CABG Transition Matrix:\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(trans_cabg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Stable   MI Reintervention Death\nStable            0.8 0.08           0.07  0.05\nMI                0.6 0.00           0.10  0.30\nReintervention    0.8 0.00           0.00  0.20\nDeath             0.0 0.00           0.00  1.00\n```\n\n\n:::\n:::\n\n\n\n\n#### 2.2.1 Validation of Transition Matrices\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrowSums(trans_cabg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        Stable             MI Reintervention          Death \n             1              1              1              1 \n```\n\n\n:::\n\n```{.r .cell-code}\ntrans_cabg[\"Death\", ]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        Stable             MI Reintervention          Death \n             0              0              0              1 \n```\n\n\n:::\n:::\n\n\n\n\n> **Beginner tip:** Rows are ‘from’, columns are ‘to’. Each row must sum to 1. ‘Death’ is an absorbing row [0,0,0,1].\n\n### Step 3: Run the Markov Model and Obtain Results\n\nThis is the core of our analysis. We will simulate a cohort of 1,000 patients over a 10-year period. We use a **`for` loop** to run the simulation for each year.\n\nThe key calculation in this step is **matrix multiplication**, denoted by `%*%` in R. In each cycle, we multiply the number of patients in each health state by the transition matrix to determine how many patients move to each new state.\n\n#### 3.1 Simulate Patient Distribution\n\n##### 3.1.1 Set up the simulation\n\nWe are starting with a cohort of 1,000 patients in the 'Stable' state.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninitial_pop <- c(Stable = 1000, MI = 0, Reintervention = 0, Death = 0)\nnum_years <- 10 # 10 years + initial state\n```\n:::\n\n\n\n\n##### 3.1.2 Storage for results\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Storage matrices for distribution over time\npci_dist <- matrix(NA_real_, nrow = num_years, ncol = length(state_names),\n                   dimnames = list(Year = 1:num_years, State = state_names))\ncabg_dist <- pci_dist\n\n# Initial distribution\npci_dist[1, ] <- initial_pop\ncabg_dist[1, ] <- initial_pop\n```\n:::\n\n\n\n\nPCI Storage Matrix\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npci_dist\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    State\nYear Stable MI Reintervention Death\n  1    1000  0              0     0\n  2      NA NA             NA    NA\n  3      NA NA             NA    NA\n  4      NA NA             NA    NA\n  5      NA NA             NA    NA\n  6      NA NA             NA    NA\n  7      NA NA             NA    NA\n  8      NA NA             NA    NA\n  9      NA NA             NA    NA\n  10     NA NA             NA    NA\n```\n\n\n:::\n:::\n\n\n\n\nCABG Storage Matrix\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncabg_dist\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    State\nYear Stable MI Reintervention Death\n  1    1000  0              0     0\n  2      NA NA             NA    NA\n  3      NA NA             NA    NA\n  4      NA NA             NA    NA\n  5      NA NA             NA    NA\n  6      NA NA             NA    NA\n  7      NA NA             NA    NA\n  8      NA NA             NA    NA\n  9      NA NA             NA    NA\n  10     NA NA             NA    NA\n```\n\n\n:::\n:::\n\n\n\n\n##### 3.1.3 Loop through years - Run the simulation and calculate state distributions\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loop through years\nfor (t in 2:num_years) {\n  pci_dist[t, ]  <- pci_dist[t-1, ]  %*% trans_pci\n  cabg_dist[t, ] <- cabg_dist[t-1, ] %*% trans_cabg\n}\n```\n:::\n\n\n\n\n##### What is a Loop?\n\nIn R, a **`for` loop** is used to repeat a block of code multiple times.\\\nHere, the loop runs once for each year of the simulation, starting from the second year (`t = 2`) until the final year (`t = num_years`).\\\nWe start at 2 because the first year (`t = 1`) already contains the initial patient distribution.\n\n##### Step-by-Step Explanation\n\n1.  **`for (t in 2:num_years)`**\n\n    -   This sets up the loop.\n\n    -   On the first run, `t = 2`. On the next run, `t = 3`, and so on, until `t = num_years`.\n\n2.  **`pci_dist[t-1, ]`**\n\n    -   This extracts the patient distribution from the previous year (`t-1`) for PCI.\n\n    -   It is a vector showing how many patients were in each health state (Stable, MI, Reintervention, Death).\n\n3.  **`%*% trans_pci`**\n\n    -   `%*%` means matrix multiplication in R.\n\n    -   Multiplying the previous year’s patient distribution by the PCI transition matrix redistributes patients into new states for the current year.\n\n4.  **`pci_dist[t, ] <- ...`**\n\n    -   The result of the multiplication (the new patient distribution) is stored in row `t` of the PCI distribution matrix.\n\n5.  **`cabg_dist[t, ] <- cabg_dist[t-1, ] %*% trans_cabg`**\n\n    -   The same operation is done for CABG, using its own transition matrix.\n\n##### Intuition\n\nEach iteration of the loop moves the entire patient cohort forward by **one cycle** (one year).\n\n-   Patients from each state “flow” into other states according to the transition probabilities.\n\n-   Over the course of the loop, row by row, we build up the full history of how patients evolve under PCI and CABG.\n\n**Formula to remember:**\n\n> Current year’s distribution = Previous year’s distribution × Transition matrix\n\n##### Show year wise patient distribution (Trace)\n\n##### PCI\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npci_dist\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    State\nYear    Stable        MI Reintervention    Death\n  1  1000.0000   0.00000        0.00000   0.0000\n  2   700.0000 150.00000      100.00000  50.0000\n  3   645.0000 105.00000      100.00000 150.0000\n  4   584.0000  96.75000       85.50000 233.7500\n  5   525.5750  87.60000       77.75000 309.0750\n  6   473.9025  78.83625       70.07750 377.1837\n  7   427.2119  71.08537       63.15750 438.5452\n  8   385.1170  64.08178       56.93826 493.8630\n  9   347.1734  57.76755       51.32806 543.7310\n  10  312.9676  52.07601       46.27085 588.6855\n```\n\n\n:::\n:::\n\n\n\n\n##### CABG\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncabg_dist\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    State\nYear    Stable       MI Reintervention    Death\n  1  1000.0000  0.00000        0.00000   0.0000\n  2   800.0000 80.00000       70.00000  50.0000\n  3   744.0000 64.00000       64.00000 128.0000\n  4   684.8000 59.52000       58.48000 197.2000\n  5   630.3360 54.78400       53.88800 260.9920\n  6   580.2496 50.42688       49.60192 319.7216\n  7   534.1373 46.41997       45.66016 373.7825\n  8   491.6900 42.73099       42.03161 423.5474\n  9   452.6159 39.33520       38.69140 469.3575\n  10  416.6469 36.20927       35.61663 511.5272\n```\n\n\n:::\n:::\n\n\n\n\n#### 3.2 Calculate Costs and QALYs\n\n##### 3.2.1 Define cost and utility vectors for easy access\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# State rewards as vectors\ncost_vec <- c(cost_stable, cost_mi, cost_reintervention, cost_death)\nutil_vec <- c(utility_stable, utility_mi, utility_reintervention, utility_death)\n```\n:::\n\n\n\n\n-   Vectors aligned to state order (e.g., `c(\"Stable\",\"MI\",\"Reintervention\",\"Death\")`).\n\n-   In each cycle:\n\n    -   **Annual cost** = sum over states of (patients in state × cost of that state).\n\n    -   **Annual QALY** = sum over states of (patients in state × utility of that state).\n\n##### 3.2.2 Pre-allocate storage for annual results\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Empty numeric vectors to fill\npci_costs  <- numeric(num_years)\npci_qalys  <- numeric(num_years)\ncabg_costs <- numeric(num_years)\ncabg_qalys <- numeric(num_years)\n```\n:::\n\n\n\n\n-   Creates numeric vectors of length `num_years` to store **discounted** cost and QALY per year for each strategy.\n\n-   Pre-allocation is faster and avoids growing objects inside the loop.\n\n##### 3.2.3 Loop through years - Calculate costs and QALYs for each cycle\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (t in 1:num_years) {\n  # undiscounted annual totals\n  pci_costs[t]  <- sum(pci_dist[t, ]  * cost_vec)\n  pci_qalys[t]  <- sum(pci_dist[t, ]  * util_vec)\n  cabg_costs[t] <- sum(cabg_dist[t, ] * cost_vec)\n  cabg_qalys[t] <- sum(cabg_dist[t, ] * util_vec)\n\n  # discount to present\n  pci_costs[t]  <- pci_costs[t]  * (1 / (1 + discount_rate_cost)^(t - 1))\n  pci_qalys[t]  <- pci_qalys[t]  * (1 / (1 + discount_rate_qaly)^(t - 1))\n  cabg_costs[t] <- cabg_costs[t] * (1 / (1 + discount_rate_cost)^(t - 1))\n  cabg_qalys[t] <- cabg_qalys[t] * (1 / (1 + discount_rate_qaly)^(t - 1))\n}\n```\n:::\n\n\n\n\n-   **Undiscounted totals:** multiply the cohort counts in each state (`pci_dist[t, ]` / `cabg_dist[t, ]`) by the state’s cost or utility, then sum.\n\n-   **Discounting:** converts future values to present value.\n\n    -   Formula: PV=value at t(1+r)t−1PV=(1+r)t−1value at t​ with rate rr (costs and QALYs may use the same or different rr).\n\n    -   We use `t-1` so that year 1 is **not** discounted (present).\n\n#### 3.3 Display Yearwise Costs and QALYs\n\n##### 3.3.1 PCI\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a data frame for PCI results\npci_results <- tibble::tibble(\n  year = 1:num_years,\n  cost = pci_costs,\n  qaly = pci_qalys\n) |> \n    gt() %>%\n  tab_header(title = \"PCI Annual Discounted Costs and QALYs\")\npci_results\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"laqsjftddu\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#laqsjftddu table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#laqsjftddu thead, #laqsjftddu tbody, #laqsjftddu tfoot, #laqsjftddu tr, #laqsjftddu td, #laqsjftddu th {\n  border-style: none;\n}\n\n#laqsjftddu p {\n  margin: 0;\n  padding: 0;\n}\n\n#laqsjftddu .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#laqsjftddu .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#laqsjftddu .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#laqsjftddu .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#laqsjftddu .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#laqsjftddu .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#laqsjftddu .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#laqsjftddu .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#laqsjftddu .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#laqsjftddu .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#laqsjftddu .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#laqsjftddu .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#laqsjftddu .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#laqsjftddu .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#laqsjftddu .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#laqsjftddu .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#laqsjftddu .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#laqsjftddu .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#laqsjftddu .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#laqsjftddu .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#laqsjftddu .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#laqsjftddu .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#laqsjftddu .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#laqsjftddu .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#laqsjftddu .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#laqsjftddu .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#laqsjftddu .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#laqsjftddu .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#laqsjftddu .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#laqsjftddu .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#laqsjftddu .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#laqsjftddu .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#laqsjftddu .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#laqsjftddu .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#laqsjftddu .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#laqsjftddu .gt_left {\n  text-align: left;\n}\n\n#laqsjftddu .gt_center {\n  text-align: center;\n}\n\n#laqsjftddu .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#laqsjftddu .gt_font_normal {\n  font-weight: normal;\n}\n\n#laqsjftddu .gt_font_bold {\n  font-weight: bold;\n}\n\n#laqsjftddu .gt_font_italic {\n  font-style: italic;\n}\n\n#laqsjftddu .gt_super {\n  font-size: 65%;\n}\n\n#laqsjftddu .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#laqsjftddu .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#laqsjftddu .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#laqsjftddu .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#laqsjftddu .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#laqsjftddu .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#laqsjftddu .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#laqsjftddu .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#laqsjftddu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"3\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>PCI Annual Discounted Costs and QALYs</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"year\">year</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cost\">cost</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"qaly\">qaly</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">1</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">50000000</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">850.0000</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">51456311</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">733.0097</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">3</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">46517108</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">642.1435</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">4</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">40229627</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">562.1715</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">5</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">35266939</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">491.9764</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">6</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">30867140</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">430.5911</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">7</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">27013830</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">376.8609</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">8</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">23643258</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">329.8349</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">9</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">20692965</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">288.6771</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">10</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">18110832</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">252.6551</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n##### 3.3.2 CABG\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a data frame for CABG results\ncabg_results <- data.frame(\n  year = 1:num_years,\n  cost = cabg_costs,\n  qaly = cabg_qalys\n) |> \n    gt() %>%\n  tab_header(title = \"CABG Annual Discounted Costs and QALYs\")\ncabg_results\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"qtzcatzutb\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#qtzcatzutb table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#qtzcatzutb thead, #qtzcatzutb tbody, #qtzcatzutb tfoot, #qtzcatzutb tr, #qtzcatzutb td, #qtzcatzutb th {\n  border-style: none;\n}\n\n#qtzcatzutb p {\n  margin: 0;\n  padding: 0;\n}\n\n#qtzcatzutb .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#qtzcatzutb .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#qtzcatzutb .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#qtzcatzutb .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#qtzcatzutb .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qtzcatzutb .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qtzcatzutb .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qtzcatzutb .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#qtzcatzutb .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#qtzcatzutb .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#qtzcatzutb .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#qtzcatzutb .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#qtzcatzutb .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#qtzcatzutb .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#qtzcatzutb .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#qtzcatzutb .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#qtzcatzutb .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#qtzcatzutb .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#qtzcatzutb .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qtzcatzutb .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#qtzcatzutb .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#qtzcatzutb .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#qtzcatzutb .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qtzcatzutb .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#qtzcatzutb .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#qtzcatzutb .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qtzcatzutb .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qtzcatzutb .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#qtzcatzutb .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qtzcatzutb .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#qtzcatzutb .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qtzcatzutb .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qtzcatzutb .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qtzcatzutb .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qtzcatzutb .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qtzcatzutb .gt_left {\n  text-align: left;\n}\n\n#qtzcatzutb .gt_center {\n  text-align: center;\n}\n\n#qtzcatzutb .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#qtzcatzutb .gt_font_normal {\n  font-weight: normal;\n}\n\n#qtzcatzutb .gt_font_bold {\n  font-weight: bold;\n}\n\n#qtzcatzutb .gt_font_italic {\n  font-style: italic;\n}\n\n#qtzcatzutb .gt_super {\n  font-size: 65%;\n}\n\n#qtzcatzutb .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#qtzcatzutb .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#qtzcatzutb .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#qtzcatzutb .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#qtzcatzutb .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#qtzcatzutb .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#qtzcatzutb .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#qtzcatzutb .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#qtzcatzutb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"3\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>CABG Annual Discounted Costs and QALYs</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"year\">year</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cost\">cost</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"qaly\">qaly</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">1</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">50000000</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">850.0000</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">50582524</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">754.3689</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">3</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">45320011</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">674.5216</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">4</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">40451458</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">602.8294</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">5</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">36157585</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">538.7586</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">6</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">32314451</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">481.4993</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">7</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">28880050</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">430.3252</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">8</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">25810664</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">384.5900</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">9</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">23067491</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">343.7156</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">10</td>\n<td headers=\"cost\" class=\"gt_row gt_right\">20615864</td>\n<td headers=\"qaly\" class=\"gt_row gt_right\">307.1853</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n#### 3.4 Add one-time initial costs and sum lifetime QALYs\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntotal_cost_pci  <- sum(pci_costs)  + (cost_pci_initial*1000)\ntotal_qaly_pci  <- sum(pci_qalys)\ntotal_cost_cabg <- sum(cabg_costs) + (cost_cabg_initial*1000)\ntotal_qaly_cabg <- sum(cabg_qalys)\n```\n:::\n\n\n\n\n-   Add the one-time initial procedure cost to the total discounted costs.\n-   Sum the discounted QALYs over the entire time horizon.\n\n#### 3.5 Display Final Results\n\n#### Final Summary of Results\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a final summary table\nsummary_df <- data.frame(\n  Procedure = c(\"PCI\", \"CABG\"),\n  Total_Lifetime_Cost = c(total_cost_pci, total_cost_cabg),\n  Total_Lifetime_QALY = c(total_qaly_pci, total_qaly_cabg)\n)\n\nsummary_df %>%\n  gt() %>%\n  tab_header(title = \"Total Lifetime Costs and QALYs\") %>%\n  fmt_currency(\n    columns = Total_Lifetime_Cost,\n    currency = \"INR\",\n    decimals = 0\n  ) %>%\n  fmt_number(\n    columns = Total_Lifetime_QALY,\n    decimals = 3\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"vdmdaubotc\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#vdmdaubotc table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#vdmdaubotc thead, #vdmdaubotc tbody, #vdmdaubotc tfoot, #vdmdaubotc tr, #vdmdaubotc td, #vdmdaubotc th {\n  border-style: none;\n}\n\n#vdmdaubotc p {\n  margin: 0;\n  padding: 0;\n}\n\n#vdmdaubotc .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#vdmdaubotc .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#vdmdaubotc .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#vdmdaubotc .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#vdmdaubotc .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vdmdaubotc .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vdmdaubotc .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vdmdaubotc .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#vdmdaubotc .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#vdmdaubotc .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#vdmdaubotc .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#vdmdaubotc .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#vdmdaubotc .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#vdmdaubotc .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#vdmdaubotc .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#vdmdaubotc .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#vdmdaubotc .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#vdmdaubotc .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#vdmdaubotc .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vdmdaubotc .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#vdmdaubotc .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#vdmdaubotc .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#vdmdaubotc .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vdmdaubotc .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#vdmdaubotc .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#vdmdaubotc .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vdmdaubotc .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vdmdaubotc .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#vdmdaubotc .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vdmdaubotc .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#vdmdaubotc .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vdmdaubotc .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vdmdaubotc .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vdmdaubotc .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vdmdaubotc .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vdmdaubotc .gt_left {\n  text-align: left;\n}\n\n#vdmdaubotc .gt_center {\n  text-align: center;\n}\n\n#vdmdaubotc .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#vdmdaubotc .gt_font_normal {\n  font-weight: normal;\n}\n\n#vdmdaubotc .gt_font_bold {\n  font-weight: bold;\n}\n\n#vdmdaubotc .gt_font_italic {\n  font-style: italic;\n}\n\n#vdmdaubotc .gt_super {\n  font-size: 65%;\n}\n\n#vdmdaubotc .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#vdmdaubotc .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#vdmdaubotc .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#vdmdaubotc .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#vdmdaubotc .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#vdmdaubotc .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#vdmdaubotc .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#vdmdaubotc .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#vdmdaubotc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"3\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Total Lifetime Costs and QALYs</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Procedure\">Procedure</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Total_Lifetime_Cost\">Total_Lifetime_Cost</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Total_Lifetime_QALY\">Total_Lifetime_QALY</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Procedure\" class=\"gt_row gt_left\">PCI</td>\n<td headers=\"Total_Lifetime_Cost\" class=\"gt_row gt_right\">&#8377;543,798,010</td>\n<td headers=\"Total_Lifetime_QALY\" class=\"gt_row gt_right\">4,957.920</td></tr>\n    <tr><td headers=\"Procedure\" class=\"gt_row gt_left\">CABG</td>\n<td headers=\"Total_Lifetime_Cost\" class=\"gt_row gt_right\">&#8377;653,200,098</td>\n<td headers=\"Total_Lifetime_QALY\" class=\"gt_row gt_right\">5,367.794</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n### Step 4: Final Economic Evaluation Metrics\n\nThis final step calculates the key metrics for our HTA: the ICER and the NMB. These metrics help us interpret the results of our model and make a decision about the cost-effectiveness of a new technology.\n\n#### ICER (Incremental Cost-Effectiveness Ratio)\n\nThe ICER tells us the additional cost required to gain one additional unit of health (one QALY) from a new technology compared to the existing standard of care.\n\n#### **Formula**\n\n$$\n\\text{ICER} = \\frac{\\Delta \\text{Cost}}{\\Delta \\text{QALY}} = \\frac{\\text{Cost}_{\\text{new}} - \\text{Cost}_{\\text{standard}}}{\\text{QALY}_{\\text{new}} - \\text{QALY}_{\\text{standard}}}\n$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndelta_cost <- total_cost_cabg - total_cost_pci\ndelta_qaly <- total_qaly_cabg - total_qaly_pci\nicer <- delta_cost / delta_qaly\n```\n:::\n\n\n\n\n#### NMB (Net Monetary Benefit)\n\nThe NMB translates health benefits into monetary terms, allowing us to see the overall value of a treatment strategy.\n\n-   Translates QALYs to money at a **willingness-to-pay** (WTP) threshold.\n\n-   **NMB** =λ×QALY−Cost=λ×QALY−Cost.\n\n-   Prefer the strategy with **higher NMB** at the chosen λλ.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwtp_threshold <- 150000\nnmb_pci  <- (total_qaly_pci  * wtp_threshold) - total_cost_pci\nnmb_cabg <- (total_qaly_cabg * wtp_threshold) - total_cost_cabg\n```\n:::\n\n\n\n\n#### Display ICER and NMB Results\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a data frame for ICER and NMB results\nicer_nmb_df <- data.frame(\n  Metric = c(\"ICER (INR per QALY)\", \"NMB PCI (INR)\", \"NMB CABG (INR)\"),\n  Value = c(icer, nmb_pci, nmb_cabg)\n)\nicer_nmb_df %>%\n  gt() %>%\n  tab_header(title = \"ICER and NMB Results\") %>%\n  fmt_currency(\n    columns = Value,\n    currency = \"INR\",\n    decimals = 2\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"tjuqoiuuxg\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#tjuqoiuuxg table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#tjuqoiuuxg thead, #tjuqoiuuxg tbody, #tjuqoiuuxg tfoot, #tjuqoiuuxg tr, #tjuqoiuuxg td, #tjuqoiuuxg th {\n  border-style: none;\n}\n\n#tjuqoiuuxg p {\n  margin: 0;\n  padding: 0;\n}\n\n#tjuqoiuuxg .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#tjuqoiuuxg .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#tjuqoiuuxg .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#tjuqoiuuxg .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#tjuqoiuuxg .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#tjuqoiuuxg .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tjuqoiuuxg .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#tjuqoiuuxg .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#tjuqoiuuxg .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#tjuqoiuuxg .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#tjuqoiuuxg .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#tjuqoiuuxg .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#tjuqoiuuxg .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#tjuqoiuuxg .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#tjuqoiuuxg .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#tjuqoiuuxg .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#tjuqoiuuxg .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#tjuqoiuuxg .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#tjuqoiuuxg .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tjuqoiuuxg .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#tjuqoiuuxg .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#tjuqoiuuxg .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#tjuqoiuuxg .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tjuqoiuuxg .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#tjuqoiuuxg .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#tjuqoiuuxg .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tjuqoiuuxg .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tjuqoiuuxg .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#tjuqoiuuxg .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tjuqoiuuxg .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#tjuqoiuuxg .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tjuqoiuuxg .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#tjuqoiuuxg .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tjuqoiuuxg .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#tjuqoiuuxg .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tjuqoiuuxg .gt_left {\n  text-align: left;\n}\n\n#tjuqoiuuxg .gt_center {\n  text-align: center;\n}\n\n#tjuqoiuuxg .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#tjuqoiuuxg .gt_font_normal {\n  font-weight: normal;\n}\n\n#tjuqoiuuxg .gt_font_bold {\n  font-weight: bold;\n}\n\n#tjuqoiuuxg .gt_font_italic {\n  font-style: italic;\n}\n\n#tjuqoiuuxg .gt_super {\n  font-size: 65%;\n}\n\n#tjuqoiuuxg .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#tjuqoiuuxg .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#tjuqoiuuxg .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#tjuqoiuuxg .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#tjuqoiuuxg .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#tjuqoiuuxg .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#tjuqoiuuxg .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#tjuqoiuuxg .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#tjuqoiuuxg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>ICER and NMB Results</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Metric\">Metric</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Value\">Value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Metric\" class=\"gt_row gt_left\">ICER (INR per QALY)</td>\n<td headers=\"Value\" class=\"gt_row gt_right\">&#8377;266,916.53</td></tr>\n    <tr><td headers=\"Metric\" class=\"gt_row gt_left\">NMB PCI (INR)</td>\n<td headers=\"Value\" class=\"gt_row gt_right\">&#8377;199,890,022.52</td></tr>\n    <tr><td headers=\"Metric\" class=\"gt_row gt_left\">NMB CABG (INR)</td>\n<td headers=\"Value\" class=\"gt_row gt_right\">&#8377;151,969,001.27</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\nicer_nmb_df\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Metric       Value\n1 ICER (INR per QALY)    266916.5\n2       NMB PCI (INR) 199890022.5\n3      NMB CABG (INR) 151969001.3\n```\n\n\n:::\n:::\n\n\n\n\n\n\n### Conclusion\n\nIn this detailed guide, we've built a Markov model from the ground up to compare PCI and CABG for coronary artery disease. We've defined health states, transition probabilities, costs, and utilities, and then simulated patient outcomes over a 10-year period. Finally, we calculated key economic evaluation metrics like the ICER and NMB to inform decision-making. This model provides a framework for understanding the long-term implications of different treatment strategies and can be adapted for other diseases and interventions. Remember, the accuracy of a Markov model depends heavily on the quality of the input data, so always ensure your parameters are based on robust clinical evidence. Happy modeling!\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"site_libs/viz-1.8.2/viz.js\"></script>\n<link href=\"site_libs/DiagrammeR-styles-0.2/styles.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/grViz-binding-1.0.11/grViz.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}